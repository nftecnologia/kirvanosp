#!/bin/bash
set -e

# Remove um PID file pré-existente do servidor.
rm -f /app/tmp/pids/server.pid

echo "Iniciando aplicação..."

# Executa migrações se for o serviço web
if [ "$1" = "web" ]; then
  echo "Executando migrações..."
  bundle exec rake db:create db:migrate || echo "Erro nas migrações, continuando..."
fi

# Executa o comando passado
exec "$@" 